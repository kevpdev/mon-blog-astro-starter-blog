---
description: Development commands, quality workflow, and essential practices
alwaysApply: true
---

# Development Workflow

## Commands

All commands are run from the root of the project using pnpm:

### Development
- `pnpm dev` - Start development server at localhost:4321
- `pnpm build` - Build production site to ./dist/
- `pnpm preview` - Preview build locally
- `pnpm astro` - Run Astro CLI commands (e.g., `pnpm astro add`, `pnpm astro check`)

### Quality & Testing
- `pnpm lint` - Run ESLint on .js, .ts, .astro files
- `pnpm lint:fix` - Run ESLint with auto-fix
- `pnpm format` - Format code with Prettier
- `pnpm format:check` - Check code formatting
- `pnpm typecheck` - Run Astro type checking
- `pnpm test` - Run Vitest tests
- `pnpm test:watch` - Run Vitest in watch mode
- `pnpm quality` - Run typecheck, lint, and format check

### Claude Commands
- `/implement-feature [name] [type]` - Structured feature implementation
- `/create-content [type] [title]` - Content creation workflow
- `/commit-push-smart [message?]` - Smart commit and push
- `/bootstrap-quality` - Setup quality tools and configs
- `/debug-issue` - Debug workflow with inputs analysis

## Quality Control Workflow

### Automated Quality Control
- **ESLint**: Static analysis with auto-fix (`pnpm lint:fix`)
- **Prettier**: Code formatting with consistent style
- **TypeScript**: Strict mode with null checks enabled
- **Pre-commit Hooks**: Husky + lint-staged (validates only modified files)
- **Quality Command**: `pnpm quality` runs typecheck + lint + format check

### Pre-commit Process
1. **Husky Hook**: Triggers on `git commit`
2. **lint-staged**: Runs only on staged files
3. **ESLint**: Validates code quality
4. **Prettier**: Ensures consistent formatting
5. **TypeScript**: Validates types
6. **Commit**: Proceeds only if all checks pass

### Quality Gates
- **Development**: `pnpm quality` before committing (enforced by pre-commit hooks)
- **CI/CD**: All quality checks must pass
- **Code Review**: Follow established patterns and standards

## File Operations Guidelines

### Important Instructions
- **ALWAYS prefer editing existing files over creating new ones**
- **NEVER create documentation files unless explicitly requested**
- **Use existing patterns and conventions from rules/**
- **Reference templates/ for new file structure**

### Architecture Compliance
- Follow component-based design patterns
- Respect layout hierarchy defined in project structure
- Use design tokens consistently
- Maintain mobile-first approach with Tailwind breakpoints
- Apply TypeScript strict patterns

## Git Workflow

### Commit Convention
- Use conventional commits format
- Run `pnpm quality` before committing
- Ensure all tests pass
- Include proper commit message ending:
  ```
  ðŸ¤– Generated with [Claude Code](https://claude.ai/code)

  Co-Authored-By: Claude <noreply@anthropic.com>
  ```

### Branch Strategy
- `main` - Production-ready code
- Feature branches for development
- No direct commits to main

## Context Referencing Strategy

### Before editing
- Check `core/` for essential patterns and standards
- Review relevant `rules/` for specialized guidance

### During development
- Reference relevant `rules/` and `templates/`
- Use `snippets/` for code patterns

### For testing
- Use `snippets/generic/vitest-config-guide.md` for aliases and coverage
- Follow testing standards in `rules/generic/testing/`

### For debugging
- Utilize `inputs/` and `snippets/` for quick fixes
- Use error handling patterns from `rules/generic/error-handling/`

### Code generation
- Use `templates/` for consistent structure
- Follow component patterns from `rules/astro/components/`

## Performance Optimization

### Context Loading Strategy
- **Core (Always Loaded)**: Essential project patterns (~200 lines)
- **Rules (Contextual Loading)**: Specialized guidance by domain (~100-150 lines each)
- **Templates (As Needed)**: Code generation templates
- **Snippets (As Needed)**: Quick code patterns

### Development Performance
- Load only relevant context based on task type
- Prefer specific snippets over full rule loading
- Use templates for rapid prototyping
- Leverage inputs/ for visual debugging workflow

## Essential Development Principles

### Code Quality
- Write no comments unless absolutely necessary
- Use strict TypeScript types only
- Max 30 lines per function, 5 params max
- Use explicit constants, no magic numbers
- Long, readable variable names

### Error Handling
- Use custom domain errors with typed error classes
- Create centralized error handling utilities
- Use `globalThis` for SSR/client compatibility
- Implement validation functions for data integrity
- Provide fallback mechanisms and retry logic

### Component Development
- Props interface at component top
- Semantic HTML structure
- Performance-first approach
- Mobile-first responsive design
- Accessibility compliance (WCAG 2.2 AA)

### Testing
- Unit tests: >80% coverage
- Integration tests for critical paths
- Write tests in English with descriptive names
- Follow Arrange-Act-Assert (AAA) pattern
- Cover edge cases and error paths