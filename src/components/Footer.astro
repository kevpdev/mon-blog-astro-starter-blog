---
import type { FooterConfig } from '../types/navigation';
import SocialLinks from './SocialLinks.astro';

interface Props {
  config: FooterConfig;
}

const { config } = Astro.props;

// Filtrer uniquement les liens activés
const enabledLinks = config.links.filter(link => link.enabled !== false);

// Construire le texte du copyright
function buildCopyrightText(copyright: FooterConfig['copyright']): string {
  if (!copyright.enabled) return '';
  
  const year = copyright.year || new Date().getFullYear();
  const company = copyright.companyName || '';
  
  return `© ${year} ${company}. ${copyright.text}`.trim();
}

const copyrightText = buildCopyrightText(config.copyright);
---

<footer class="footer">
  <div class="footer__content">
    <!-- Liens du footer -->
    {enabledLinks.length > 0 && (
      <nav>
        <ul class="footer__links">
          {enabledLinks.map((link) => (
            <li>
              <a
                href={link.href}
                class="footer__link"
                target={link.external ? '_blank' : undefined}
                rel={link.external ? 'noopener noreferrer' : undefined}
              >
                {link.label}
              </a>
            </li>
          ))}
        </ul>
      </nav>
    )}

    <!-- Liens sociaux -->
    {config.social.enabled && config.social.links.length > 0 && (
      <div class="footer__social">
        <SocialLinks 
          links={config.social.links}
          size={config.social.size || 'medium'}
          direction="horizontal"
        />
      </div>
    )}

    <!-- Copyright -->
    {config.copyright.enabled && copyrightText && (
      <p class="footer__copyright">
        {copyrightText}
      </p>
    )}
  </div>
</footer>
